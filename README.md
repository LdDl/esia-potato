# ESIA oAuth –∫–ª–∏–µ–Ω—Ç –Ω–∞ Go

–î–≤–µ –≤–µ—Ä—Å–∏–∏ README:

üá∑üá∫ [–†—É—Å—Å–∫–∏–π](README.md) | üá∫üá∏ [English](README_en.md)

–ü–æ–ø—ã—Ç–∫–∞ —Å–¥–µ–ª–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é oAuth —á–µ—Ä–µ–∑ –ï–°–ò–ê —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ –ì–û–°–¢.
–ë–µ–∑ –≥–æ—Ç–æ–≤—ã—Ö Docker —Å–±–æ—Ä–æ–∫ —Å –ø—Ä–æ–ø–∞—Ç—á–µ–Ω–Ω—ã–º OpenSSL –∏–ª–∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç OpenSSL –∫–∞–∫ —Ç–∞–∫–æ–≤–æ–≥–æ.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–ß—Ç–æ —É–º–µ–µ—Ç](#—á—Ç–æ-—É–º–µ–µ—Ç)
- [–í–≤–æ–¥–Ω—ã–µ](#–≤–≤–æ–¥–Ω—ã–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ](#–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ-–ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ-–∫–ª—é—á–∞-–∏–∑-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞-–∫—Ä–∏–ø—Ç–æ–ø—Ä–æ)
- [–ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –ï–°–ò–ê](#–ø—Ä–∏–º–µ—Ä-–∫–ª–∏–µ–Ω—Ç–∞-–µ—Å–∏–∞)
- [HTTP API —Å–µ—Ä–≤–µ—Ä](#http-api-—Å–µ—Ä–≤–µ—Ä)

## –ß—Ç–æ —É–º–µ–µ—Ç

- –ü–æ–¥–ø–∏—Å—å –ì–û–°–¢ –† 34.10-2012 (256 –±–∏—Ç)
- –•–µ—à –ì–û–°–¢ –† 34.11-2012 (–°—Ç—Ä–∏–±–æ–≥-256)
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ CMS/PKCS#7 SignedData
- –†–∞–±–æ—Ç–∞ —Å –∫–ª—é—á–∞–º–∏ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ

## –í–≤–æ–¥–Ω—ã–µ

- –î–ª—è —Å–±–æ—Ä–∫–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –Ω—É–∂–µ–Ω Go 1.21+
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" - —ç—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–∏–ª–∏ –∞—Ä—Ö–∏–≤ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ), –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –∫–ª—é—á–∞ –∏–∑ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
esia-potato/
|--- cms/
|    --- cms.go                   # CMS/PKCS#7 SignedData
|--- cryptopro/
|    --- extract.go               # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–µ–π
|--- httpapi/
|    |--- handlers.go             # HTTP —Ö–µ–Ω–¥–ª–µ—Ä—ã
|    |--- archive.go              # –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤
|    `--- types.go                # –¢–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
|--- utils/
|    --- bytes.go                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
|--- cmd/
|    |--- cryptopro_extract_service/
|    |    --- main.go             # HTTP API —Å–µ—Ä–≤–µ—Ä (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
|    |--- cryptopro_extract/
|    |    --- main.go             # CLI –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–µ–π
|    |--- example/
|    |    --- main.go             # –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –ï–°–ò–ê (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
|    `--- example_api/
|         --- main.go             # –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –ï–°–ò–ê (HTTP API)
`--- test_container/              # –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏. –í gitignore, —Ç–∞–∫ –∫–∞–∫ –≤–∞—à–∏ –±—É–¥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

* –î–ª—è —É—Ç–∏–ª–∏—Ç—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–µ–π –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ
- –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ CLI:
  ```bash
  go install github.com/LdDl/esia-potato/cmd/cryptopro_extract@latest
  cryptopro_extract -h
  ```

- –ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Å–æ–±—Ä–∞—Ç—å –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
  ```bash
  git clone git@github.com:LdDl/esia-potato.git --depth 1
  cd esia-potato
  go run ./cmd/cryptopro_extract -h
  ```

## –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ —Ö—Ä–∞–Ω–∏—Ç –∫–ª—é—á–∏ –≤ –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º [–ì–û–°–¢ 28147](https://ru.wikipedia.org/wiki/%D0%93%D0%9E%D0%A1%D0%A2_28147-89).

- –° –ø–æ–º–æ—â—å—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ CLI:
  ```bash
  cryptopro_extract -p –ü–ò–ù_–ö–û–î_–ü–ê–†–û–õ–¨ ./container.000
  ```

- –ò–ª–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
  ```bash
  go run ./cmd/cryptopro_extract -p –ü–ò–ù_–ö–û–î_–ü–ê–†–û–õ–¨ ./container.000
  ```

–ï—Å–ª–∏ –≤—Å—ë –û–ö, —Ç–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞:

```
{"time":"2025-12-29T20:36:00.591340886+03:00","level":"INFO","msg":"container opened","path":"./test_container","curve_oid":"1.2.643.2.2.36.0"}
{"time":"2025-12-29T20:36:01.065829042+03:00","level":"INFO","msg":"primary key extracted","curve_oid":"1.2.643.2.2.36.0","fingerprint":"0123456789abcdef","private_key":"a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2"}
{"time":"2025-12-29T20:36:01.065854001+03:00","level":"WARN","msg":"secondary key found but not extracted","masks":"masks2.key","primary":"primary2.key"}
{"time":"2025-12-29T20:36:01.065858097+03:00","level":"INFO","msg":"done"}
```

–ï—Å–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º:
```
secondary key found but not extracted
````
, —Ç–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî –≤—Ç–æ—Ä–∏—á–Ω—ã–π –∫–ª—é—á –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–¥–ø–∏—Å–∏, —Ç.–∫. –¥–ª—è oAuth –≤ –ï–°–ò–ê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.

–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ï–°–ò–ê.

## –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –ï–°–ò–ê

- –í–æ–∑—å–º–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ –≤—ã–≤–æ–¥–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ `cmd/example/main.go` –≤ `keyHex`.
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä:
  ```bash
  go run ./cmd/example/main.go
  ```

–ï—Å–ª–∏ –≤—Å—ë –û–ö, —Ç–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞:
```
{"time":"2025-12-29T20:47:23.876107574+03:00","level":"INFO","msg":"message prepared","message":"openid2025.12.29 17:47:23 +0000775607_DP0f9439ef-3581-4de5-9b8c-d20135960331"}
{"time":"2025-12-29T20:47:23.878111012+03:00","level":"INFO","msg":"signature created","signature_bytes":2927,"base64_chars":3904}
{"time":"2025-12-29T20:47:23.8781677+03:00","level":"INFO","msg":"authorization URL prepared","url":"https://esia-portal1.test.gosuslugi.ru/aas/oauth2/ac?access_type=offline&client_id=775607_DP&client_secret=–≥–∏–≥–∞–Ω—Ç—Å–∫–∏–π_jwt_—Ç–æ–∫–µ–Ω&redirect_uri=https%3A%2F%2Fya.ru&response_type=code&scope=openid&state=0f9439ef-3581-4de5-9b8c-d20135960331&timestamp=2025.12.29+17%3A47%3A23+%2B0000"}
{"time":"2025-12-29T20:47:23.878185114+03:00","level":"INFO","msg":"testing against ESIA"}
{"time":"2025-12-29T20:47:23.95390256+03:00","level":"INFO","msg":"response received","status":"302 ","location":"https://esia-portal1.test.gosuslugi.ru/login"}
{"time":"2025-12-29T20:47:23.953918261+03:00","level":"INFO","msg":"signature accepted by ESIA"}
```

–†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–¥–ø–∏—Å—å –ø—Ä–æ—à–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –≤—Å—ë –æ–∫.

## –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –ï–°–ò–ê (—á–µ—Ä–µ–∑ HTTP API)

–ï—Å–ª–∏ –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫—É, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—è HTTP API –≤–µ—Ä—Å–∏–µ–π.

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ HTTP API —Å–µ—Ä–≤–µ—Ä:
   ```bash
   go run ./cmd/cryptopro_extract_service/main.go
   ```

2. –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä:
   ```bash
   go run ./cmd/example_api/main.go
   ```

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä:
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ `/api/v1/extract` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–∞
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ `/api/v1/sign` –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ï–°–ò–ê

## HTTP API —Å–µ—Ä–≤–µ—Ä

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Ä—è–¥–µ —Å–ª—É—á–∞–µ–≤ –µ—Å—Ç—å HTTP API —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å –∫–ª—é—á–∏ –∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ REST API.

### –ó–∞–ø—É—Å–∫

- –° –ø–æ–º–æ—â—å—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ CLI:
  ```bash
  go install github.com/LdDl/esia-potato/cmd/cryptopro_extract_service@latest
  cryptopro_extract_service -host 0.0.0.0 -port 8080
  ```

- –ò–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
  ```bash
  go run ./cmd/cryptopro_extract_service/main.go -host 0.0.0.0 -port 8080
  ```

### API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- **OpenAPI JSON:** http://localhost:8080/docs/swagger.json
- **UI (RapiDoc):** http://localhost:8080/docs

  <img src="rapidoc1.png" alt="API Example" width="720px"/>

- [RapiDoc](https://rapidocweb.com/) - UI –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞.

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl http://localhost:8080/health
```

**–û—Ç–≤–µ—Ç:**
```json
{"status":"ok"}
```

#### POST /api/v1/extract

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ.

**–ó–∞–ø—Ä–æ—Å:** `multipart/form-data`
- `file` - –∞—Ä—Ö–∏–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`.zip` –∏–ª–∏ `.tar.gz`)
- `pin` - –ø–∏–Ω-–∫–æ–¥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:8080/api/v1/extract \
  -F "file=@container.zip" \
  -F "pin=12345"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "private_key_hex": "a1b2c3d4...",
  "public_key_hex": "e5f6a7b8...",
  "fingerprint": "0123456789abcdef",
  "curve_oid": "1.2.643.2.2.36.0",
  "certificate_base64": "MIIBkTCB..."
}
```

–ü–æ–ª–µ `certificate_base64` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω `certificate.cer`). –ï–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ `/api/v1/sign`.

#### POST /api/v1/sign

–ü–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞.

**–ó–∞–ø—Ä–æ—Å:** `application/json`
```json
{
  "private_key_hex": "a1b2c3d4...",
  "certificate_base64": "MIIBkTCB...",
  "message": "—Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏"
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:8080/api/v1/sign \
  -H "Content-Type: application/json" \
  -d '{
    "private_key_hex": "a1b2c3d4...",
    "certificate_base64": "MIIBkTCB...",
    "message": "openid2025.01.01 12:00:00 +0000CLIENT_ID12345"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "signature_base64": "MIIBygYJKoZIhvcNAQc..."
}
```

### –ü—Ä–∏–º–µ—Ä: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏ –ø–æ–¥–ø–∏—Å—å

```bash
# 1. –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–ª—é—á –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
RESP=$(curl -s -X POST http://localhost:8080/api/v1/extract \
  -F "file=@container.zip" \
  -F "pin=12345")

# 2. –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è –∏–∑ –æ—Ç–≤–µ—Ç–∞
KEY=$(echo $RESP | jq -r .private_key_hex)
CERT=$(echo $RESP | jq -r .certificate_base64)

# 3. –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
curl -X POST http://localhost:8080/api/v1/sign \
  -H "Content-Type: application/json" \
  -d "{
    \"private_key_hex\": \"$KEY\",
    \"certificate_base64\": \"$CERT\",
    \"message\": \"openid2025.01.01 12:00:00 +0000CLIENT_ID12345\"
  }"
```
